<!-- Angular Component Forget Password - Styles et scripts gérés dans angular.json -->
<!-- Preloader -->
<div class="preloader">
  <img src="assets/images/logos/logo_societe.png" alt="loader" class="lds-ripple img-fluid" width="80" />
</div>
<div id="main-wrapper" class="auth-customizer-none">
  <div class="position-relative overflow-hidden radial-gradient min-vh-100 w-100 d-flex align-items-center justify-content-center">
    <div class="d-flex align-items-center justify-content-center w-100">
      <div class="row justify-content-center w-100">
        <div class="col-md-10 col-lg-8 col-xl-6 col-xxl-5 auth-card">
          <div class="card mb-0">
            <div class="card-body pt-5">
              <a routerLink="/" class="text-nowrap logo-img text-center d-block mb-3 w-100">
                <img src="assets/images/logos/logo_societe.png" width="180" alt="Velosi ERP" />
              </a>
              
              <!-- Slogan de la société -->
              <div class="text-center mb-4">
                
                <p class="text-muted fs-5 mb-0">Votre partenaire de confiance</p>
                <p class="text-muted fs-6 mb-0">Transport & Logistique</p>
              </div>
              
              <!-- Message d'information avec animation -->
              <div class="text-center mb-4 p-3 rounded-3 bg-light-info border border-info-subtle">
                <div class="mb-3">
                  <iconify-icon icon="solar:shield-keyhole-bold-duotone" 
                                class="fs-8 text-info animate__animated animate__pulse animate__infinite"></iconify-icon>
                </div>
                <h5 class="fw-semibold text-dark mb-2">Récupération de mot de passe</h5>
                <p class="mb-0 text-muted fs-4">
                  Saisissez votre adresse email professionnelle et vous allez recevoir un code OTP 
                  par SMS ou email pour réinitialiser votre mot de passe en toute sécurité.
                </p>
              </div>
              
              <!-- Formulaire de récupération -->
              <form (ngSubmit)="onSubmit()" #forgotForm="ngForm">
                <!-- Champ Email avec icône -->
                <div class="mb-4">
                  <label for="email" class="form-label fw-semibold">
                    <iconify-icon icon="solar:letter-bold" class="me-2 text-primary"></iconify-icon>
                    Adresse email professionnelle
                  </label>
                  <div class="input-group">
                    <span class="input-group-text bg-light-primary">
                      <iconify-icon icon="solar:letter-linear" class="text-primary"></iconify-icon>
                    </span>
                    <input type="email" 
                           class="form-control ps-3" 
                           id="email" 
                           name="email" 
                           [(ngModel)]="forgotData.email" 
                           required 
                           placeholder="votre.email@velosi.com"
                           pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
                  </div>
                  <div class="form-text text-muted mt-2">
                    <iconify-icon icon="solar:info-circle-linear" class="me-1"></iconify-icon>
                    Utilisez votre adresse email d'entreprise Velosi
                  </div>
                </div>
                
                <!-- Boutons d'action -->
                <div class="d-grid gap-2 mb-3">
                  <button type="submit" 
                          class="btn btn-primary py-3 rounded-3 fw-semibold" 
                          [disabled]="!forgotForm.valid || isLoading">
                    <span *ngIf="!isLoading">
                      <iconify-icon icon="solar:shield-check-bold" class="me-2"></iconify-icon>
                      Envoyer le lien de récupération
                    </span>
                    <span *ngIf="isLoading">
                      <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                      Envoi en cours...
                    </span>
                  </button>
                </div>
                
                <!-- Lien retour login -->
                <div class="text-center">
                  <a routerLink="/login" 
                     class="btn bg-light-secondary text-secondary w-100 py-3 rounded-3 fw-medium">
                    <iconify-icon icon="solar:alt-arrow-left-bold" class="me-2"></iconify-icon>
                    Retour à la connexion
                  </a>
                </div>
              </form>
              
              <!-- Message de succès -->
              <div *ngIf="emailSent" class="alert alert-success mt-3 rounded-3">
                <div class="d-flex align-items-center">
                  <iconify-icon icon="solar:check-circle-bold" class="fs-6 me-2"></iconify-icon>
                  <div>
                    <strong>Code OTP envoyé !</strong><br>
                    <small>Redirection vers la page de vérification en cours...</small>
                  </div>
                </div>
              </div>
              
              <!-- Message d'erreur -->
              <div *ngIf="errorMessage" class="alert alert-danger mt-3 rounded-3">
                <div class="d-flex align-items-center">
                  <iconify-icon icon="solar:danger-circle-bold" class="fs-6 me-2"></iconify-icon>
                  <div>
                    <strong>Erreur :</strong><br>
                    <small>{{ errorMessage }}</small>
                  </div>
                </div>
              </div>
              
              <!-- Information de sécurité -->
              <div class="text-center mt-4">
                <div class="border-top pt-3">
                  <p class="text-muted fs-4 mb-0">
                    <iconify-icon icon="solar:shield-check-linear" class="me-1 text-success"></iconify-icon>
                    Connexion sécurisée SSL • Protection des données
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
